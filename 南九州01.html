<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å—ä¹å·äº”æ—¥éŠåŠ©æ‰‹</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #e67e22;
            --bg: #f4f7f6;
            --card: #ffffff;
            --text: #333;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 70px; }
        
        /* Header */
        header { background: var(--primary); color: white; padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 1.2rem; }
        
        /* Navigation */
        nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); z-index: 100; }
        nav button { background: none; border: none; font-size: 0.9rem; color: #7f8c8d; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        nav button.active { color: var(--secondary); font-weight: bold; }
        nav button span { font-size: 1.2rem; margin-bottom: 2px; }

        /* Sections */
        .section { display: none; padding: 15px; max-width: 600px; margin: 0 auto; }
        .section.active { display: block; }

        /* Itinerary Cards */
        .day-card { background: var(--card); border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .day-header { font-weight: bold; color: var(--secondary); margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; display: flex; justify-content: space-between; }
        .spot { display: flex; align-items: center; margin: 10px 0; padding: 8px; background: #f9f9f9; border-radius: 6px; cursor: pointer; transition: background 0.2s; }
        .spot:active { background: #eee; }
        .spot-icon { margin-right: 10px; font-size: 1.2rem; }
        .spot-info { flex: 1; }
        .spot-name { font-weight: 500; font-size: 1rem; }
        .hotel { margin-top: 10px; padding: 10px; background: #e8f6f3; border-radius: 6px; color: #16a085; font-size: 0.9rem; }
        
        /* Expense Tracker */
        .input-group { display: flex; gap: 10px; margin-bottom: 10px; }
        input, select { padding: 10px; border: 1px solid #ddd; border-radius: 5px; flex: 1; font-size: 1rem; }
        button.btn-add { background: var(--secondary); color: white; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; width: 100%; cursor: pointer; }
        .expense-list { margin-top: 20px; }
        .expense-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; background: white; }
        .total-banner { background: var(--primary); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        
        /* Tools */
        .tool-card { background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .weather-btn { display: block; width: 100%; padding: 12px; margin: 5px 0; background: #3498db; color: white; text-align: center; text-decoration: none; border-radius: 5px; }
        .rate-calc { display: flex; flex-direction: column; gap: 10px; }
        
        /* Utilities */
        .delete-btn { color: red; margin-left: 10px; cursor: pointer; }
        .badge { font-size: 0.8em; background: #eee; padding: 2px 6px; border-radius: 4px; color: #666; }
    </style>
</head>
<body>

<header>
    <h1>å—ä¹å·äº”æ—¥éŠåŠ©æ‰‹</h1>
</header>

<div id="itinerary" class="section active">
    <div class="day-card">
        <div class="day-header">Day 1 <span>é¹¿å…’å³¶</span></div>
        <div onclick="openMap('æ¡ƒåœ’åœ‹éš›æ©Ÿå ´')" class="spot"><span class="spot-icon">âœˆï¸</span><div class="spot-info"><div class="spot-name">æ¡ƒåœ’åœ‹éš›æ©Ÿå ´</div></div></div>
        <div onclick="openMap('é¹¿å…’å³¶ç©ºæ¸¯')" class="spot"><span class="spot-icon">ğŸ›¬</span><div class="spot-info"><div class="spot-name">é¹¿å…’å³¶ç©ºæ¸¯</div></div></div>
        <div onclick="openMap('é¹¿å…’å³¶ç‡’é…’å’Œå•¤é…’ä¸»é¡Œæ¨‚åœ’')" class="spot"><span class="spot-icon">ğŸº</span><div class="spot-info"><div class="spot-name">é¹¿å…’å³¶ç‡’é…’å’Œå•¤é…’ä¸»é¡Œæ¨‚åœ’</div></div></div>
        <div onclick="openMap('praha-genvçŸ¥è¦½æ­¦å®¶å±‹æ•·')" class="spot"><span class="spot-icon">ğŸ¯</span><div class="spot-info"><div class="spot-name">çŸ¥è¦½æ­¦å®¶å±‹æ•·</div></div></div>
        <div onclick="openMap('å¤©æ–‡é¤¨å•†åº—è¡—')" class="spot"><span class="spot-icon">ğŸ›ï¸</span><div class="spot-info"><div class="spot-name">å¤©æ–‡é¤¨å•†åº—è¡—</div></div></div>
        <div onclick="openMap('åŸå±±ãƒ›ãƒ†ãƒ«é¹¿å…å³¶')" class="hotel">ğŸ¨ ä½å®¿ï¼šåŸå±±ãƒ›ãƒ†ãƒ«é¹¿å…å³¶</div>
    </div>

    <div class="day-card">
        <div class="day-header">Day 2 <span>æ«»å³¶/éœ§å³¶</span></div>
        <div onclick="openMap('åŸå±±å…¬åœ’å±•æœ›å°')" class="spot"><span class="spot-icon">ğŸ‘€</span><div class="spot-info"><div class="spot-name">åŸå±±å…¬åœ’å±•æœ›å°</div></div></div>
        <div onclick="openMap('ä»™å·–åœ’')" class="spot"><span class="spot-icon">ğŸŒ¸</span><div class="spot-info"><div class="spot-name">ä»™å·–åœ’</div></div></div>
        <div onclick="openMap('é¹¿å…’å³¶æ¸¯')" class="spot"><span class="spot-icon">ğŸš¢</span><div class="spot-info"><div class="spot-name">æ«»å³¶æ¸¡è¼ª (é¹¿å…’å³¶æ¸¯~æ«»å³¶æ¸¯)</div></div></div>
        <div onclick="openMap('æœ‰æ‘ç†”å²©å±•æœ›æ‰€')" class="spot"><span class="spot-icon">ğŸŒ‹</span><div class="spot-info"><div class="spot-name">æœ‰æ‘ç†”å²©å±•æœ›æ‰€</div></div></div>
        <div onclick="openMap('éœ§å³¶ç¥å®®')" class="spot"><span class="spot-icon">â›©ï¸</span><div class="spot-info"><div class="spot-name">éœ§å³¶ç¥å®®</div></div></div>
        <div onclick="openMap('éœ§å³¶å›½éš›ãƒ›ãƒ†ãƒ«')" class="hotel">ğŸ¨ ä½å®¿ï¼šéœ§å³¶å›½éš›ãƒ›ãƒ†ãƒ«</div>
    </div>

    <div class="day-card">
        <div class="day-header">Day 3 <span>å®®å´æ—¥å—</span></div>
        <div onclick="openMap('é—œä¹‹å°¾ç€‘å¸ƒ')" class="spot"><span class="spot-icon">ğŸŒŠ</span><div class="spot-info"><div class="spot-name">é—œä¹‹å°¾ç€‘å¸ƒ</div></div></div>
        <div onclick="openMap('AEONå¤¢æ¨‚åŸå®®å´')" class="spot"><span class="spot-icon">ğŸ›’</span><div class="spot-info"><div class="spot-name">AEON å¤¢æ¨‚åŸ</div></div></div>
        <div onclick="openMap('æ—¥å—å¤ªé™½èŠ±åœ’')" class="spot"><span class="spot-icon">ğŸ—¿</span><div class="spot-info"><div class="spot-name">æ—¥å—å¤ªé™½èŠ±åœ’ (æ‘©è‰¾çŸ³åƒ)</div></div></div>
        <div onclick="openMap('éµœæˆ¶ç¥å®®')" class="spot"><span class="spot-icon">ğŸ‡</span><div class="spot-info"><div class="spot-name">éµœæˆ¶ç¥å®®</div></div></div>
        <div onclick="openMap('å®®å´è§€å…‰é£¯åº—')" class="hotel">ğŸ¨ ä½å®¿ï¼šå®®å´è§€å…‰é£¯åº—</div>
    </div>

    <div class="day-card">
        <div class="day-header">Day 4 <span>é«˜åƒç©—</span></div>
        <div onclick="openMap('é£«è‚¥åŸè·¡')" class="spot"><span class="spot-icon">ğŸ¯</span><div class="spot-info"><div class="spot-name">é£«è‚¥åŸè·¡</div></div></div>
        <div onclick="openMap('é«˜åƒç©—å¤©ç…§éµé“')" class="spot"><span class="spot-icon">ğŸš‚</span><div class="spot-info"><div class="spot-name">é«˜åƒç©—å¤©ç…§éµé“</div></div></div>
        <div onclick="openMap('é«˜åƒç©—å³½')" class="spot"><span class="spot-icon">ğŸš£</span><div class="spot-info"><div class="spot-name">é«˜åƒç©—å³½/çœŸåäº•ç€‘å¸ƒ</div></div></div>
        <div onclick="openMap('é«˜åƒç©—ç¥ç¤¾')" class="spot"><span class="spot-icon">ğŸŒ²</span><div class="spot-info"><div class="spot-name">é«˜åƒç©—ç¥ç¤¾ (å¤«å¦»æ¨¹/éµç‹›çŠ¬)</div></div></div>
        <div onclick="openMap('ANA Crowne Plaza Kumamoto New Sky')" class="hotel">ğŸ¨ ä½å®¿ï¼šANA Crowne Plaza Kumamoto</div>
    </div>

    <div class="day-card">
        <div class="day-header">Day 5 <span>ç†Šæœ¬/è¿”ç¨‹</span></div>
        <div onclick="openMap('ç†Šæœ¬åŸ')" class="spot"><span class="spot-icon">ğŸ¯</span><div class="spot-info"><div class="spot-name">ç†Šæœ¬åŸ</div></div></div>
        <div onclick="openMap('SAKURA MACHI Kumamoto')" class="spot"><span class="spot-icon">ğŸ›ï¸</span><div class="spot-info"><div class="spot-name">æ«»ç”ºè³¼ç‰©ä¸­å¿ƒ</div></div></div>
        <div onclick="openMap('æ°´å‰å¯ºæˆè¶£åœ’')" class="spot"><span class="spot-icon">ğŸµ</span><div class="spot-info"><div class="spot-name">æ°´å‰å¯ºæˆè¶£åœ’</div></div></div>
        <div onclick="openMap('ç†Šæœ¬æ©Ÿå ´')" class="spot"><span class="spot-icon">ğŸ›«</span><div class="spot-info"><div class="spot-name">ç†Šæœ¬ç©ºæ¸¯ -> æ¡ƒåœ’</div></div></div>
    </div>
</div>

<div id="expenses" class="section">
    <div class="total-banner">
        <div>ç¸½æ”¯å‡º (ç´„åˆå°å¹£)</div>
        <h2 id="totalTWD">NT$ 0</h2>
        <div style="font-size:0.8rem; opacity:0.8">ç¸½æ—¥å¹£: Â¥<span id="totalJPY">0</span></div>
    </div>

    <div class="tool-card">
        <h3>æ–°å¢æ¶ˆè²»</h3>
        <div class="input-group">
            <input type="text" id="descInput" placeholder="é …ç›® (å¦‚: æ‹‰éºµ)">
            <input type="number" id="amtInput" placeholder="æ—¥å¹£é‡‘é¡">
        </div>
        <button class="btn-add" onclick="addExpense()">+ è¨˜ä¸€ç­†</button>
    </div>

    <div id="expenseList" class="expense-list">
        </div>
    <div style="text-align:center; margin-top:20px;">
        <button onclick="clearExpenses()" style="color:red; background:none; border:none; text-decoration:underline;">æ¸…é™¤æ‰€æœ‰ç´€éŒ„</button>
    </div>
</div>

<div id="tools" class="section">
    <div class="tool-card">
        <h3>ğŸŒ¤ï¸ åŠæ™‚å¤©æ°£é å ±</h3>
        <p style="font-size:0.9rem; color:#666;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•æŸ¥çœ‹æ—¥æœ¬æ°£è±¡å»³æœ€æ–°é å ±ï¼š</p>
        <a href="https://tenki.jp/forecast/9/46/8810/" target="_blank" class="weather-btn">é¹¿å…’å³¶ (Kagoshima)</a>
        <a href="https://tenki.jp/forecast/9/45/8710/" target="_blank" class="weather-btn">å®®å´ (Miyazaki)</a>
        <a href="https://tenki.jp/forecast/9/43/8610/" target="_blank" class="weather-btn">ç†Šæœ¬ (Kumamoto)</a>
    </div>

    <div class="tool-card">
        <h3>ğŸ’° åŒ¯ç‡æ›ç®— (JPY â†’ TWD)</h3>
        <div class="rate-calc">
            <div style="display:flex; align-items:center; gap:5px;">
                <label>ç›®å‰åŒ¯ç‡:</label>
                <input type="number" id="rate" value="0.215" step="0.001" style="width:80px;" oninput="convertCurrency()">
            </div>
            <div class="input-group">
                <input type="number" id="calcJpy" placeholder="è¼¸å…¥æ—¥å¹£" oninput="convertCurrency()">
                <div style="display:flex; align-items:center; font-weight:bold;">= NT$ <span id="calcTwd" style="margin-left:5px; color:var(--secondary);">0</span></div>
            </div>
        </div>
    </div>
</div>

<nav>
    <button onclick="switchTab('itinerary', this)" class="active"><span>ğŸ“…</span>è¡Œç¨‹</button>
    <button onclick="switchTab('expenses', this)"><span>ğŸ’¸</span>è¨˜å¸³</button>
    <button onclick="switchTab('tools', this)"><span>ğŸ§°</span>å·¥å…·</button>
</nav>

<script>
    // 1. Navigation Logic
    function switchTab(tabId, btn) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        document.querySelectorAll('nav button').forEach(el => el.classList.remove('active'));
        btn.classList.add('active');
    }

    // 2. Google Maps Logic
    function openMap(locationName) {
    const query = encodeURIComponent(locationName);
    // ä½¿ç”¨ Google Maps å®˜æ–¹æœå°‹ URL çµæ§‹
    window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
    }
 

    // 3. Expense Tracker Logic
    let expenses = JSON.parse(localStorage.getItem('tripExpenses')) || [];
    let currentRate = 0.215; // Default rate

    function renderExpenses() {
        const list = document.getElementById('expenseList');
        const totalTwdEl = document.getElementById('totalTWD');
        const totalJpyEl = document.getElementById('totalJPY');
        
        list.innerHTML = '';
        let totalJpy = 0;

        expenses.slice().reverse().forEach((item, index) => {
            totalJpy += parseFloat(item.amount);
            const twdVal = Math.round(item.amount * currentRate);
            
            const div = document.createElement('div');
            div.className = 'expense-item';
            div.innerHTML = `
                <div>
                    <div style="font-weight:bold;">${item.desc}</div>
                    <div class="badge">NT$ ${twdVal}</div>
                </div>
                <div style="display:flex; align-items:center;">
                    <span style="font-weight:bold;">Â¥${item.amount}</span>
                    <span class="delete-btn" onclick="deleteExpense(${expenses.length - 1 - index})">Ã—</span>
                </div>
            `;
            list.appendChild(div);
        });

        totalJpyEl.innerText = totalJpy;
        totalTwdEl.innerText = 'NT$ ' + Math.round(totalJpy * currentRate).toLocaleString();
    }

    function addExpense() {
        const desc = document.getElementById('descInput').value;
        const amt = document.getElementById('amtInput').value;
        
        if(desc && amt) {
            expenses.push({ desc: desc, amount: parseFloat(amt) });
            localStorage.setItem('tripExpenses', JSON.stringify(expenses));
            document.getElementById('descInput').value = '';
            document.getElementById('amtInput').value = '';
            renderExpenses();
        } else {
            alert('è«‹è¼¸å…¥é …ç›®å’Œé‡‘é¡');
        }
    }

    function deleteExpense(originalIndex) {
        if(confirm('ç¢ºå®šåˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿ')) {
            expenses.splice(originalIndex, 1);
            localStorage.setItem('tripExpenses', JSON.stringify(expenses));
            renderExpenses();
        }
    }

    function clearExpenses() {
        if(confirm('ç¢ºå®šæ¸…ç©ºæ‰€æœ‰è¨˜å¸³è³‡æ–™ï¼Ÿ')) {
            expenses = [];
            localStorage.setItem('tripExpenses', JSON.stringify(expenses));
            renderExpenses();
        }
    }

    // 4. Converter Logic
    function convertCurrency() {
        const rate = parseFloat(document.getElementById('rate').value);
        const jpy = parseFloat(document.getElementById('calcJpy').value);
        currentRate = rate;
        
        if(!isNaN(jpy)) {
            document.getElementById('calcTwd').innerText = Math.round(jpy * rate);
        } else {
            document.getElementById('calcTwd').innerText = '0';
        }
        renderExpenses(); // Re-calculate total with new rate
    }

    // Initialize
    renderExpenses();
</script>

</body>
</html>